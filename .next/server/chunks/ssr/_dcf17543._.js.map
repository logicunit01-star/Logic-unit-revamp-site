{"version":3,"sources":["../../../../lib/api.ts","../../../../components/insights_page/BlockRenderer.tsx/__nextjs-internal-proxy.mjs","../../../../app/insights/%5Bslug%5D/page.tsx"],"sourcesContent":["import { Post } from './cms';\n\nconst STRAPI_URL = 'http://localhost:1337';\nconst API_URL = `${STRAPI_URL}/api/articles?populate=*`;\n\n// Generic Strapi type supporting BOTH wrapped and unwrapped responses\nexport type StrapiPost = {\n  id: number;\n  attributes?: any; // If attributes wrapper exists\n} & Record<string, any>; // If attributes wrapper was removed\n\n// Safe mapper for Strapi â†’ Your Post type\nexport const mapStrapiPostToPost = (strapiPost: StrapiPost): Post => {\n  if (!strapiPost) {\n    throw new Error(\"Invalid Strapi post structure\");\n  }\n\n  // SUPPORT BOTH STRUCTURES:\n  // 1) { id, attributes: { ... } }\n  // 2) { id, title, slug, ... }\n  const attrs = strapiPost.attributes || strapiPost;\n\n  if (!attrs) {\n    throw new Error(\"Invalid Strapi post structure: missing attributes\");\n  }\n\n  // Handle cover image\n  let imageUrl = 'https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop';\n\n  const coverUrl = attrs.cover?.data?.attributes?.url;\n  if (coverUrl) {\n    imageUrl = coverUrl.startsWith('http') ? coverUrl : `${STRAPI_URL}${coverUrl}`;\n  }\n\n  // Handle author avatar\n  let avatarUrl = 'https://logic-unit.com/wp-content/uploads/2019/06/cropped-logic-unit-logo.png';\n\n  const avatarAttr = attrs.author?.data?.attributes?.avatar?.data?.attributes?.url;\n  if (avatarAttr) {\n    avatarUrl = avatarAttr.startsWith('http') ? avatarAttr : `${STRAPI_URL}${avatarAttr}`;\n  }\n\n  return {\n    slug: attrs.slug || '',\n    title: attrs.title || 'Untitled',\n    postDescription:\n      attrs.description ||\n      (attrs.content\n        ? attrs.content.replace(/<[^>]*>?/gm, '').slice(0, 150) + '...'\n        : ''),\n    excerpt: attrs.excerpt || '',\n    image: imageUrl,\n\n    author: {\n      name: attrs.author?.data?.attributes?.name || 'Logic-Unit Team',\n      avatar: avatarUrl,\n    },\n\n    date: attrs.publishedAt\n      ? new Date(attrs.publishedAt).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n      })\n      : '',\n\n    category: (() => {\n      // Debug: log the category structure\n      console.log('Category structure:', JSON.stringify(attrs.category, null, 2));\n\n      // Handle wrapped structure: { data: { id, documentId, attributes: { name } } }\n      if (attrs.category?.data) {\n        return {\n          id: attrs.category.data.id || 0,\n          documentId: attrs.category.data.documentId || '',\n          name: attrs.category.data.attributes?.name || 'Insights',\n        };\n      }\n\n      // Handle unwrapped structure: { id, documentId, name }\n      if (attrs.category?.id) {\n        return {\n          id: attrs.category.id,\n          documentId: attrs.category.documentId || '',\n          name: attrs.category.name || 'Insights',\n        };\n      }\n\n      // Default fallback\n      return {\n        id: 0,\n        documentId: '',\n        name: 'Insights',\n      };\n    })(),\n\n    content: attrs.content || '',\n    blocks: attrs.block || attrs.blocks || [], // Support both 'block' and 'blocks' field names\n  };\n};\n\n// Fetch ALL posts\nexport const fetchPosts = async (): Promise<Post[]> => {\n  try {\n    console.log('Fetching posts from:', API_URL);\n    const res = await fetch(API_URL, { cache: 'no-store' });\n\n    console.log('Response status:', res.status);\n    if (!res.ok) throw new Error(`Failed to fetch posts: ${res.status}`);\n\n    const json = await res.json();\n\n    console.log('API Response data length:', json.data?.length);\n\n    if (!Array.isArray(json.data)) {\n      console.error(\"Invalid API response structure\", json);\n      return [];\n    }\n\n    const mappedPosts = json.data\n      .map((p) => {\n        try {\n          return mapStrapiPostToPost(p);\n        } catch (e) {\n          console.error(\"Error mapping post:\", e);\n          return null;\n        }\n      })\n      .filter((p): p is Post => p !== null);\n\n    console.log(`Returning ${mappedPosts.length} mapped posts`);\n    return mappedPosts;\n  } catch (error) {\n    console.error(\"Error fetching posts:\", error);\n    return [];\n  }\n};\n\n// Fetch SINGLE POST by slug\nexport const fetchPostBySlug = async (slug: string): Promise<Post | null> => {\n  try {\n    const url = `${STRAPI_URL}/api/articles?filters[slug][$eq]=${slug}&populate=*`;\n    const res = await fetch(url, { cache: 'no-store' });\n\n    if (!res.ok) throw new Error(`Failed to fetch post: ${res.status}`);\n\n    const json = await res.json();\n\n    if (!json.data || !Array.isArray(json.data) || json.data.length === 0) {\n      return null;\n    }\n\n    return mapStrapiPostToPost(json.data[0]);\n  } catch (error) {\n    console.error(\"Error fetching post:\", error);\n    return null;\n  }\n};","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/insights_page/BlockRenderer.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/insights_page/BlockRenderer.tsx\",\n    \"default\",\n);\n","import React from 'react';\nimport Link from 'next/link';\nimport { fetchPostBySlug } from '@/lib/api';\nimport type { Metadata } from 'next';\nimport BlockRenderer from '@/components/insights_page/BlockRenderer';\nexport async function generateMetadata({ params }: { params: Promise<{ slug: string }> }): Promise<Metadata> {\n  const { slug } = await params;\n  const post = await fetchPostBySlug(slug);\n\n  if (!post) {\n    return { title: 'Post Not Found' };\n  }\n\n  return {\n    title: post.title.replace(/<[^>]*>/g, ''),\n    description: post.excerpt || post.postDescription || 'Read this article on Logic-Unit Insights.',\n  };\n}\n\n// Helper function to clean content strings\nconst cleanContent = (content: string) => {\n  if (typeof content !== 'string') return '';\n  return content.replace(/<p>\\s*(<h[1-6][^>]*>[\\s\\S]*?<\\/h[1-6]>)\\s*<\\/p>/gi, '$1');\n};\n\nexport default async function BlogPostPage({ params }: { params: Promise<{ slug: string }> }) {\n  const { slug } = await params;\n  const post = await fetchPostBySlug(slug);\n\n  if (!post) {\n    return <div className=\"py-32 text-center text-2xl\">Post Not Found</div>;\n  }\n\n  return (\n    <article className=\"bg-white py-16 sm:py-24\">\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl\">\n        <Link href=\"/insights\" className=\"mb-8 inline-block font-semibold text-brand-accent hover:text-brand-secondary transition-colors\">\n          &larr; Back to Insights\n        </Link>\n\n        {/* Title */}\n        <h1\n          className=\"text-4xl md:text-5xl font-extrabold font-heading bg-clip-text text-transparent bg-gradient-to-r from-brand-primary to-brand-accent pb-2 mb-4\"\n          dangerouslySetInnerHTML={{ __html: post.title }}\n        />\n\n        {/* Excerpt */}\n        {post.excerpt && (\n          <p className=\"text-xl text-brand-gray mb-8 leading-relaxed italic border-l-4 border-brand-primary pl-6 py-2\">\n            {post.excerpt}\n          </p>\n        )}\n\n        {/* Author and Date */}\n        <div className=\"flex items-center space-x-4 mb-8 text-brand-dark/70\">\n          <img src={post.author.avatar} alt={post.author.name} className=\"w-12 h-12 rounded-full border-2 border-brand-secondary object-cover\" />\n          <div>\n            <p className=\"font-semibold\">{post.author.name}</p>\n            <p className=\"text-sm\">{post.date}</p>\n          </div>\n        </div>\n\n        {/* Featured Image */}\n        {post.image && (\n          <img src={post.image} alt={post.title} className=\"w-full h-auto max-h-[500px] object-cover rounded-lg shadow-xl mb-12\" />\n        )}\n\n        {/* Blocks (Dynamic Content) */}\n        {post.blocks && post.blocks.length > 0 ? (\n          <BlockRenderer blocks={post.blocks} />\n        ) : (\n          /* Fallback to regular content if no blocks */\n          <div className=\"prose lg:prose-xl max-w-none text-brand-dark/80 prose-headings:font-heading prose-headings:text-brand-dark prose-a:text-brand-primary prose-img:rounded-lg prose-p:leading-relaxed prose-p:mb-6\">\n            {typeof post.content === 'string' ? (\n              <div dangerouslySetInnerHTML={{ __html: cleanContent(post.content) }} />\n            ) : (\n              post.content\n            )}\n          </div>\n        )}\n      </div>\n\n      <div className=\"mt-24\">\n\n      </div>\n    </article>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[1]}